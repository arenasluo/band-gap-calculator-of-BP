clc; 
clear all

%%%%%%%%%%%% Universal varies %%%%%%%%%%%%%%%%%%
D=3.85*exp(-3.66/(1273*8.617e-5))+4.44*exp(-4.0/(1273*8.617e-5)); % diffusivity @ 1000 C 
r=1;
s=1;bb=1;
z=1;q=1;
qq=1;e=1;sq=1;
rs=1;
re=1;sm=1;
qs=1;
ee=1;ts=1;
te=1;
tq=1;
n=1;% counter
u=(1e15-1e18)/(4.1e-13);

% mesh grid: delta(x)=2e-8 (cm)
% time step: 0.001 (s)


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%% starting point %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%     x axis  (width)      %%%%%%%%%%%%%%%%%%%%%%%
for n=1:1:6
    x(n)=2.1e-4-(2e-8)*(n-1);
end
for b=6:-1:1
    j(z)=x(n);
    z=z+1;
    n=n-1;
end
for r=1:1:205
    j(z)=2.1e-4+(2e-8)*(r);
    z=z+1;
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%% y axis (concentration) %%%%%%%%%%%%%%%%%%%%%%%%%
u=(1e15-1e18)/(4.1e-13);
for b=2.1e-4:-2e-8:2.099e-4
    c(q)=u*(b-2.12e-4).^2+1e15-u*(2.1e-6)^2;
    q=q+1;
end

for b=6:-1:1
    o(s)=c(b);
    s=s+1;
end
for b=7:1:206
    o(b)=1e18;
end
for b=207:1:211
    o(b)=c(b-205);
end
%%%%%%%%%%%%%%%%%%%%% make same x&y vectors lengths. %%%%%%%%%%%%%%%%%%%%%%%
for i=1:1:82
    N1(i)=NaN;
end
for i=83:1:293
    N1(i)=j(i-82);
end
for i=294:1:375
    N1(i)=NaN;
end
for i=1:1:81
    M1(i)=NaN;
end
for i=83:1:293
    M1(i)=o(i-82);
end
for i=294:1:375
    M1(i)=NaN;
end
x1=N1;
y1=M1;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%% T = 5 s %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%     x axis  (width)      %%%%%%%%%%%%%%%%%%%%%%%
for b=2.099e-4:2e-8:2.1e-4
    cc(qq)=u*(b-2.12e-4).^2+1e15-u*(2.1e-6)^2;
    qq=qq+1;
end
for b=2.1002e-4:2e-8:2.14e-4
    cc(qq)=1e18;
    qq=qq+1;
end
for b=2.1402e-4:2e-8:2.141e-4
    cc(qq)=u*(b-2.12e-4).^2+1e15-u*(2.1e-6)^2;
    qq=qq+1;
end
for n=1:1:39
    xx(n)=2.1e-4-(2e-8)*(n-1);
end
for n=39:-1:1
    jj(bb)=xx(n);
    bb=bb+1;
end
for n=1:1:238
    jj(bb)=2.1e-4+(2e-8)*(n);
    bb=bb+1;
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%% y axis (concentration) %%%%%%%%%%%%%%%%%%%%%%
for pp=1:1:33
    fc(pp)=0;
end
for pp=34:1:244
    fc(pp)=cc(e);
    e=e+1;
end
for pp=245:1:278
    fc(pp)=0;
end


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  Diffusion  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
for z=1:1:(5/0.001)
    for s=2:1:277
        fc(s)=fc(s)+D*0.001*(fc(s-1)+fc(s+1)-2*fc(s))/((2e-8)^2);%2e-8 cm,0.2nm
    end
end

%%%%%%%%%%%%%%%%%%%%% make same x&y vectors lengths. %%%%%%%%%%%%%%%%%%%%%%%
for i=1:1:48
    M2(i)=NaN;
end
for i=49:1:325
    M2(i)=jj(i-48);
end
for i=326:1:373
    M2(i)=NaN;
end
for i=1:1:48
    N2(i)=NaN;
end
for i=49:1:325
    N2(i)=fc(i-47);
end
for i=326:1:373
    N2(i)=NaN;
end
x2=M2;
y2=N2;


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%% T = 10 s %%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%     x axis  (width)      %%%%%%%%%%%%%%%%%%%%%%%

for b=2.099e-4:2e-8:2.1e-4
    tc(tq)=u*(b-2.12e-4).^2+1e15-u*(2.1e-6)^2;
    tq=tq+1;
end
for b=2.1002e-4:2e-8:2.14e-4
    tc(tq)=1e18;
    tq=tq+1;
end
for b=2.1402e-4:2e-8:2.141e-4
    tc(tq)=u*(b-2.12e-4).^2+1e15-u*(2.1e-6)^2;
    tq=tq+1;
end

for n=1:1:53
    tx(n)=2.1e-4-(2e-8)*(n-1);
end
for n=53:-1:1
    tj(ts)=tx(n);
    ts=ts+1;
end
for n=1:1:252
    tj(ts)=2.1e-4+(2e-8)*(n);
    ts=ts+1;
end

%%%%%%%%%%%%%%%%%%%%%%%%%%%% y axis (concentration) %%%%%%%%%%%%%%%%%%%%%%
for tp=1:1:47
    gc(tp)=0;
end
for tp=48:1:258
    gc(tp)=tc(te);
    te=te+1;
end
for tp=259:1:306
    gc(tp)=0;
end

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  Diffusion  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
for z=1:1:(10/0.001)
    for s=2:1:305
        gc(s)=gc(s)+D*0.001*(gc(s-1)+gc(s+1)-2*gc(s))/((2e-8)^2);%2e-8 cm,0.2nm
    end
end
%%%%%%%%%%%%%%%%%%%%% make same x&y vectors lengths. %%%%%%%%%%%%%%%%%%%%%%%
for i=1:1:35
    N3(i)=NaN;
end
for i=36:1:338
    N3(i)=tj(i-35);
end
for i=339:1:373
    N3(i)=NaN;
end
for i=1:1:35
    M3(i)=NaN;
end
for i=36:1:338
    M3(i)=gc(i-35);
end
for i=339:1:373
    M3(i)=NaN;
end
x3=N3;
y3=M3;


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%% T = 20 s %%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%     x axis  (width)      %%%%%%%%%%%%%%%%%%%%%%%
for n=1:1:72
    tx(n)=2.1e-4-(2e-8)*(n-1);
end
for n=72:-1:1
    uj(rs)=tx(n);
    rs=rs+1;
end
for n=1:1:271
    uj(rs)=2.1e-4+(2e-8)*(n);
    rs=rs+1;
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%% y axis (concentration) %%%%%%%%%%%%%%%%%%%%%%
for b=2.099e-4:2e-8:2.1e-4
    sc(sm)=u*(b-2.12e-4).^2+1e15-u*(2.1e-6)^2;
    sm=sm+1;
end
for b=2.1002e-4:2e-8:2.14e-4
    sc(sm)=1e18;
    sm=sm+1;
end
for b=2.1402e-4:2e-8:2.141e-4
    sc(sm)=u*(b-2.12e-4).^2+1e15-u*(2.1e-6)^2;
    sm=sm+1;
end
for sp=1:1:66
    hc(sp)=0;
end
for sp=66:1:276
    hc(sp)=sc(re);
    re=re+1;
end
for sp=276:1:342
    hc(sp)=0;
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  Diffusion  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
for z=1:1:(20/0.001)
    for s=2:1:340
        hc(s)=hc(s)+D*0.001*(hc(s-1)+hc(s+1)-2*hc(s))/((2e-8)^2);%2e-8 cm,0.2nm
    end
end

%%%%%%%%%%%%%%%%%%%%% make same x&y vectors lengths. %%%%%%%%%%%%%%%%%%%%%%%
for i=1:1:16
    N4(i)=NaN;
end
for i=17:1:358
    N4(i)=uj(i-16);
end
for i=358:1:373
    N4(i)=NaN;
end
for i=1:1:16
    M4(i)=NaN;
end
for i=17:1:358
    M4(i)=hc(i-16);
end
for i=358:1:373
    M4(i)=NaN;
end
x4=N4;
y4=M4;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%% T = 30 s %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%     x axis  (width)      %%%%%%%%%%%%%%%%%%%%%%%
for n=1:1:87
    tx(n)=2.1e-4-(2e-8)*(n-1);
end
for n=87:-1:1
    wj(qs)=tx(n);
    qs=qs+1;
end
for n=1:1:286
    wj(qs)=2.1e-4+(2e-8)*(n);
    qs=qs+1;
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%% y axis (concentration) %%%%%%%%%%%%%%%%%%%%%%
for b=2.099e-4:2e-8:2.1e-4
    sc(sq)=u*(b-2.12e-4)^2+1e15-u*(2.1e-6)^2;
    sq=sq+1;
end
for b=2.1002e-4:2e-8:2.14e-4
    sc(sq)=1e18;
    sq=sq+1;
end
for b=2.1402e-4:2e-8:2.141e-4
    sc(sq)=u*(b-2.12e-4)^2+1e15-u*(2.1e-6)^2;
    sq=sq+1;
end

for sp=1:1:81
    ic(sp)=0;
end
for sp=82:1:292
    ic(sp)=sc(ee);
    ee=ee+1;
end
for sp=293:1:373
    ic(sp)=0;
end

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  Diffusion  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
for z=1:1:(30/0.001)
    for s=2:1:372
        ic(s)=ic(s)+D*0.001*(ic(s-1)+ic(s+1)-2*ic(s))/((2e-8)^2);%2e-8 cm,0.2nm
    end
end
x5=wj;
y5=ic;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  Plot figure  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
plot(x1,y1,'-k','LineWidth',0.1);
hold on
plot(x2,y2,'sr');
hold on
plot(x3,y3,'*g','LineWidth',0.1);
hold on
plot(x4,y4,'xm','LineWidth',0.1);
hold on
plot(x5,y5,'ob','LineWidth',0.1);
axis([2.077e-4 2.163e-4 1e15 1.05e18]);
xlabel('X (cm)');
ylabel('concentration');
grid on

