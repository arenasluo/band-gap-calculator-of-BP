clc; 
clear all


%%%%%%%%%%%% Universal varies %%%%%%%%%%%%%%%%%%
ni=exp(-0.605/(1273*8.617e-5))*3.9e16*(1273)^(1.5);
a=1;c=1;e=1;g=0.001;h=(3.85*exp(-3.66/(1273*8.617e-5))+4.44*exp(-4.0/(1273*8.617e-5)));o=((2e-8)^2)
u=(1e15-1e20)/(4.1e-13);


%%%%%%%%%%%%%%%%%%%%%%%%%     x axis  (width)      %%%%%%%%%%%%%%%%%%%%%%%
for b=1.899e-4:2e-8:2.341e-4
    x(a)=b;
    a=a+1;
end

%%%%%%%%%%%%%%%%%%%%%%%%%     y axis  (width)      %%%%%%%%%%%%%%%%%%%%%%%
for b=1.899e-4:2e-8:2.0988e-4 
    y(c)=0;
    c=c+1;
end
for b=2.099e-4:2e-8:2.1e-4
    y(c)=u*(b-2.12e-4).^2+1e15-u*(2.1e-6)^2;
    c=c+1;
end
for b=2.1002e-4:2e-8:2.1398e-4
    y(c)=1e20;
    c=c+1;
end
for b=2.14e-4:2e-8:2.141e-4
    y(c)=u*(b-2.12e-4).^2+1e15-u*(2.1e-6)^2;
    c=c+1;
end
for b=2.1412e-4:2e-8:2.341e-4
    y(c)=0;
    c=c+1;
end
p=y;k=y;
parfor j=1:1:2211
    D(j)=0;
end

for e=1:1:1800/0.001
    for j=1:1:2211
        D(j)=h*(1+1/sqrt(1+4*(ni/k(j))^2));
    end
    for j=2:1:2210
        k(j)=k(j)+D(j)*0.001*(k(j+1)-(j))/o+D(j-1)*0.001*(k(j-1)-k(j))/o;
    end 
    %for j=1001:1:1105
     %   k(2211-j)=k(j);
    %end
    
end

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  Plot figure  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%plot(x,p,'k');
%hold on
plot(x,k,'-r');
hold on

plot(x,y,'-b');
axis([1.899e-4 2.341e-4 0 1.05e20]);
xlabel('X (cm)');
ylabel('concentration');
grid on
