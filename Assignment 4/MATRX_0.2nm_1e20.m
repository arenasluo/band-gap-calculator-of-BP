clc; 
clear all

%%%%%%%%%%%% Universal varies %%%%%%%%%%%%%%%%%%
ni=exp(-0.605/(1273*8.617e-5))*3.9e16*(1273)^(1.5);
a=1;c=1;e=1;g=0.001;
u=(1e15-1e20)/(4.1e-13);
D=1;

%%%%%%%%%%%%%%%%%%%%%%%%%     x axis  (width)      %%%%%%%%%%%%%%%%%%%%%%%
for b=2.04e-4:2e-8:2.2e-4
    x(a)=b;
    a=a+1;
end

%%%%%%%%%%%%%%%%%%%%%%%%%     y axis  (width)      %%%%%%%%%%%%%%%%%%%%%%%
for b=2.04e-4:2e-8:2.0988e-4 
    y(c)=0;
    c=c+1;
end
for b=2.099e-4:2e-8:2.1e-4
    y(c)=u*(b-2.12e-4).^2+1e15-u*(2.1e-6)^2;
    c=c+1;
end
for b=2.1002e-4:2e-8:2.1398e-4
    y(c)=1e20;
    c=c+1;
end
for b=2.14e-4:2e-8:2.141e-4
    y(c)=u*(b-2.12e-4).^2+1e15-u*(2.1e-6)^2;
    c=c+1;
end
for b=2.1412e-4:2e-8:2.2e-4
    y(c)=0;
    c=c+1;
end
p=y;
k=y;
l=y;
m=y;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 % diffusivity @ 1000 C=D(fermi)+D(electrical) 
 %D=(3.85*exp(-3.66/(1273*8.617e-5))+4.44*exp(-4.0/(1273*8.617e-5)))*(1+1/sqrt(1+4*(ni/y)^2));
for e=1:1:(5/g)
    for f=2:1:401
        D(402-f)=(3.85*exp(-3.66/(1273*8.617e-5))+4.44*exp(-4.0/(1273*8.617e-5)))*(1+1/sqrt(1+4*(ni/y(402-f))^2));
        y(f)=y(f)+D(f-1)*g*(y(f-1)+y(f+1)-2*y(f))/((2e-8)^2);%2e-8 cm,0.2nm
        y(801-f)=y(f);
    end
end
%end
for e=1:1:(10/g)
    for f=2:1:401
        D(402-f)=(3.85*exp(-3.66/(1273*8.617e-5))+4.44*exp(-4.0/(1273*8.617e-5)))*(1+1/sqrt(1+4*(ni/k(402-f))^2));
        k(f)=k(f)+D(f-1)*g*(k(f-1)+k(f+1)-2*k(f))/((2e-8)^2);%2e-8 cm,0.2nm
        k(801-f)=k(f);
    end
end
for e=1:1:(20/g)
    for f=2:1:401
        D(402-f)=(3.85*exp(-3.66/(1273*8.617e-5))+4.44*exp(-4.0/(1273*8.617e-5)))*(1+1/sqrt(1+4*(ni/l(402-f))^2));
        l(f)=l(f)+D(f-1)*g*(l(f-1)+l(f+1)-2*l(f))/((2e-8)^2);%2e-8 cm,0.2nm
        l(801-f)=l(f);
    end
end
for e=1:1:(30/g)
    for f=2:1:401
        D(402-f)=(3.85*exp(-3.66/(1273*8.617e-5))+4.44*exp(-4.0/(1273*8.617e-5)))*(1+1/sqrt(1+4*(ni/m(402-f))^2));
        m(f)=m(f)+D(f-1)*g*(m(f-1)+m(f+1)-2*m(f))/((2e-8)^2);%2e-8 cm,0.2nm
        m(801-f)=m(f);
    end
end


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  Plot figure  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
plot(x,p,'k');
hold on
plot(x,k,'*m','LineWidth',0.1);
hold on
plot(x,l,'sr');
hold on
plot(x,m,'o','LineWidth',0.1);
hold on
plot(x,y,'-b','LineWidth',0.1);
axis([2.05e-4 2.1e-4 1e17 1.05e20]);
xlabel('X (cm)');
ylabel('concentration');
grid on