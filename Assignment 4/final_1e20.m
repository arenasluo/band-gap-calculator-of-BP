clc; 
clear all


%%%%%%%%%%%% Universal varies %%%%%%%%%%%%%%%%%%
ni=exp(-0.605/(1273*8.617e-5))*3.9e16*(1273)^(1.5);
a=1;c=1;e=1;g=0.001;h=(3.85*exp(-3.66/(1273*8.617e-5))+4.44*exp(-4.0/(1273*8.617e-5)));o=((2e-8)^2);
u=(1e15-1e20)/(4.1e-13);
%%%%%%%%%%%%%%%%%%%%%%%%%     x axis  (width)      %%%%%%%%%%%%%%%%%%%%%%%
for b=1.899e-4:2e-8:2.341e-4
    x(a)=b;
    a=a+1;
end

%%%%%%%%%%%%%%%%%%%%%%%%%     y axis  (width)      %%%%%%%%%%%%%%%%%%%%%%%
for b=1.899e-4:2e-8:2.0988e-4 
    y(c)=0;
    c=c+1;
end
for b=2.099e-4:2e-8:2.1e-4
    y(c)=u*(b-2.12e-4).^2+1e15-u*(2.1e-6)^2;
    c=c+1;
end
for b=2.1002e-4:2e-8:2.1398e-4
    y(c)=1e20;
    c=c+1;
end
for b=2.14e-4:2e-8:2.141e-4
    y(c)=u*(b-2.12e-4).^2+1e15-u*(2.1e-6)^2;
    c=c+1;
end
for b=2.1412e-4:2e-8:2.341e-4
    y(c)=0;
    c=c+1;
end
p=y;k=y;r=y;s=y;
j=1:1:2211;
D(j)=0;

for e=1:1:300/0.006
    j=1:1:2211;
        D(j)=h.*(1+1./sqrt(1+4*(ni./k(j)).^2));
    j=2:1:2210;
        k(j)=k(j)+D(j)*0.006.*(k(j+1)-k(j))./o+D(j-1)*0.006.*(k(j-1)-k(j))./o;
    %for j=1001:1:1105
     %   k(2211-j)=k(j);
    %end 
end

for e=1:1:600/0.006
    j=1:1:2211;
        D(j)=h.*(1+1./sqrt(1+4*(ni./p(j)).^2));
    j=2:1:2210;
        p(j)=p(j)+D(j)*0.006.*(p(j+1)-p(j))./o+D(j-1)*0.006.*(p(j-1)-p(j))./o;
    %for j=1001:1:1105
     %   k(2211-j)=k(j);
    %end 
end

for e=1:1:1200/0.006
    j=1:1:2211;
        D(j)=h.*(1+1./sqrt(1+4*(ni./r(j)).^2));
    j=2:1:2210;
        r(j)=r(j)+D(j)*0.006.*(r(j+1)-r(j))./o+D(j-1)*0.006.*(r(j-1)-r(j))./o;
    %for j=1001:1:1105
     %   k(2211-j)=k(j);
    %end
end

for e=1:1:1800/0.006
    j=1:1:2211;
        D(j)=h.*(1+1./sqrt(1+4*(ni./s(j)).^2));
    j=2:1:2210;
        s(j)=s(j)+D(j)*0.006.*(s(j+1)-s(j))./o+D(j-1)*0.006.*(s(j-1)-s(j))./o;
    %for j=1001:1:1105
     %   k(2211-j)=k(j);
    %end
end

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  Plot figure  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%plot(x,p,'k');
%hold on
plot(x,k,'-r');
hold on
plot(x,p,'-m');
hold on
plot(x,r,'*k');
hold on
plot(x,s,'o');
hold on
plot(x,y,'-b');
axis([1.895e-4 2.345e-4 1e16 1.05e20]);
xlabel('X (cm)');
ylabel('concentration');
grid on
