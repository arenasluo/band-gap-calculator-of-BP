clc; 
clear all

%%%%%%%%%%%% Universal varies %%%%%%%%%%%%%%%%%%
D=1.2662e-14; % diffusivity @ 1000 C 
r=1;
s=1;bb=1;
z=1;q=1;
qq=1;e=1;sq=1;
rs=1;
re=1;sm=1;
qs=1;
ee=1;ts=1;
te=1;
tq=1;
n=1;% counter
u=(1e15-1e18)/(4.1e-13);

% mesh grid: delta(x)=2e-8 (cm)
% time step: 0.001 (s)


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%% starting point %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%     x axis  (width)      %%%%%%%%%%%%%%%%%%%%%%%
for n=1:1:6
    x(n)=2.1e-4-(2e-8)*(n-1);
end
for b=6:-1:1
    j(z)=x(n);
    z=z+1;
    n=n-1;
end
for r=1:1:205
    j(z)=2.1e-4+(2e-8)*(r);
    z=z+1;
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%% y axis (concentration) %%%%%%%%%%%%%%%%%%%%%%%%%
u=(1e15-1e18)/(4.1e-13);
for b=2.1e-4:-2e-8:2.099e-4
    c(q)=u*(b-2.12e-4).^2+1e15-u*(2.1e-6)^2;
    q=q+1;
end

for b=6:-1:1
    o(s)=c(b);
    s=s+1;
end
for b=7:1:206
    o(b)=1e18;
end
for b=207:1:211
    o(b)=c(b-205);
end
%%%%%%%%%%%%%%%%%%%%% make same x&y vectors lengths. %%%%%%%%%%%%%%%%%%%%%%%
for i=1:1:62
    N1(i)=NaN;
end
for i=63:1:273
    N1(i)=j(i-62);
end
for i=274:1:335
    N1(i)=NaN;
end
for i=1:1:62
    M1(i)=NaN;
end
for i=63:1:273
    M1(i)=o(i-62);
end
for i=274:1:335
    M1(i)=NaN;
end
x1=N1;
y1=M1;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%% T = 5 s %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%     x axis  (width)      %%%%%%%%%%%%%%%%%%%%%%%
for b=2.099e-4:2e-8:2.1e-4
    cc(qq)=u*(b-2.12e-4).^2+1e15-u*(2.1e-6)^2;
    qq=qq+1;
end
for b=2.1002e-4:2e-8:2.14e-4
    cc(qq)=1e18;
    qq=qq+1;
end
for b=2.1402e-4:2e-8:2.141e-4
    cc(qq)=u*(b-2.12e-4).^2+1e15-u*(2.1e-6)^2;
    qq=qq+1;
end
for n=1:1:32
    xx(n)=2.1e-4-(2e-8)*(n-1);
end
for n=32:-1:1
    jj(bb)=xx(n);
    bb=bb+1;
end
for n=1:1:231
    jj(bb)=2.1e-4+(2e-8)*(n);
    bb=bb+1;
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%% y axis (concentration) %%%%%%%%%%%%%%%%%%%%%%
for pp=1:1:31
    fc(pp)=0;
end
for pp=32:1:232
    fc(pp)=cc(e);
    e=e+1;
end
for pp=232:1:263
    fc(pp)=0;
end


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  Diffusion  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
for z=1:1:(5/0.001)
    for s=2:1:262
        fc(s)=fc(s)+D*0.001*(fc(s-1)+fc(s+1)-2*fc(s))/((2e-8)^2);%2e-8 cm,0.2nm
    end
end

%%%%%%%%%%%%%%%%%%%%% make same x&y vectors lengths. %%%%%%%%%%%%%%%%%%%%%%%
for i=1:1:36
    M2(i)=NaN;
end
for i=37:1:299
    M2(i)=jj(i-36);
end
for i=300:1:335
    M2(i)=NaN;
end
for i=1:1:36
    N2(i)=NaN;
end
for i=37:1:299
    N2(i)=fc(i-36);
end
for i=300:1:335
    N2(i)=NaN;
end
x2=M2;
y2=N2;


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%% T = 10 s %%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%     x axis  (width)      %%%%%%%%%%%%%%%%%%%%%%%

for b=2.099e-4:2e-8:2.1e-4
    tc(tq)=u*(b-2.12e-4).^2+1e15-u*(2.1e-6)^2;
    tq=tq+1;
end
for b=2.1002e-4:2e-8:2.14e-4
    tc(tq)=1e18;
    tq=tq+1;
end
for b=2.1402e-4:2e-8:2.141e-4
    tc(tq)=u*(b-2.12e-4).^2+1e15-u*(2.1e-6)^2;
    tq=tq+1;
end

for n=1:1:42
    tx(n)=2.1e-4-(2e-8)*(n-1);
end
for n=42:-1:1
    tj(ts)=tx(n);
    ts=ts+1;
end
for n=1:1:241
    tj(ts)=2.1e-4+(2e-8)*(n);
    ts=ts+1;
end

%%%%%%%%%%%%%%%%%%%%%%%%%%%% y axis (concentration) %%%%%%%%%%%%%%%%%%%%%%
for tp=1:1:36
    gc(tp)=0;
end
for tp=37:1:247
    gc(tp)=tc(te);
    te=te+1;
end
for tp=248:1:283
    gc(tp)=0;
end

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  Diffusion  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
for z=1:1:(10/0.001)
    for s=2:1:282
        gc(s)=gc(s)+D*0.001*(gc(s-1)+gc(s+1)-2*gc(s))/((2e-8)^2);%2e-8 cm,0.2nm
    end
end
%%%%%%%%%%%%%%%%%%%%% make same x&y vectors lengths. %%%%%%%%%%%%%%%%%%%%%%%
for i=1:1:26
    N3(i)=NaN;
end
for i=27:1:309
    N3(i)=tj(i-26);
end
for i=310:1:335
    N3(i)=NaN;
end
for i=1:1:26
    M3(i)=NaN;
end
for i=27:1:309
    M3(i)=gc(i-26);
end
for i=310:1:335
    M3(i)=NaN;
end
x3=N3;
y3=M3;


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%% T = 20 s %%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%     x axis  (width)      %%%%%%%%%%%%%%%%%%%%%%%
for n=1:1:57
    tx(n)=2.1e-4-(2e-8)*(n-1);
end
for n=57:-1:1
    uj(rs)=tx(n);
    rs=rs+1;
end
for n=1:1:256
    uj(rs)=2.1e-4+(2e-8)*(n);
    rs=rs+1;
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%% y axis (concentration) %%%%%%%%%%%%%%%%%%%%%%
for b=2.099e-4:2e-8:2.1e-4
    sc(sm)=u*(b-2.12e-4).^2+1e15-u*(2.1e-6)^2;
    sm=sm+1;
end
for b=2.1002e-4:2e-8:2.14e-4
    sc(sm)=1e18;
    sm=sm+1;
end
for b=2.1402e-4:2e-8:2.141e-4
    sc(sm)=u*(b-2.12e-4).^2+1e15-u*(2.1e-6)^2;
    sm=sm+1;
end
for sp=1:1:51
    hc(sp)=0;
end
for sp=51:1:261
    hc(sp)=sc(re);
    re=re+1;
end
for sp=262:1:313
    hc(sp)=0;
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  Diffusion  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
for z=1:1:(20/0.001)
    for s=2:1:312
        hc(s)=hc(s)+D*0.001*(hc(s-1)+hc(s+1)-2*hc(s))/((2e-8)^2);%2e-8 cm,0.2nm
    end
end

%%%%%%%%%%%%%%%%%%%%% make same x&y vectors lengths. %%%%%%%%%%%%%%%%%%%%%%%
for i=1:1:11
    N4(i)=NaN;
end
for i=12:1:324
    N4(i)=uj(i-11);
end
for i=325:1:335
    N4(i)=NaN;
end
for i=1:1:11
    M4(i)=NaN;
end
for i=12:1:324
    M4(i)=hc(i-11);
end
for i=325:1:335
    M4(i)=NaN;
end
x4=N4;
y4=M4;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%% T = 30 s %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
%%%%%%%%%%%%%%%%%%%%%%%%%     x axis  (width)      %%%%%%%%%%%%%%%%%%%%%%%
for n=1:1:68
    tx(n)=2.1e-4-(2e-8)*(n-1);
end
for n=68:-1:1
    wj(qs)=tx(n);
    qs=qs+1;
end
for n=1:1:267
    wj(qs)=2.1e-4+(2e-8)*(n);
    qs=qs+1;
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%% y axis (concentration) %%%%%%%%%%%%%%%%%%%%%%
for b=2.099e-4:2e-8:2.1e-4
    sc(sq)=u*(b-2.12e-4)^2+1e15-u*(2.1e-6)^2;
    sq=sq+1;
end
for b=2.1002e-4:2e-8:2.14e-4
    sc(sq)=1e18;
    sq=sq+1;
end
for b=2.1402e-4:2e-8:2.141e-4
    sc(sq)=u*(b-2.12e-4)^2+1e15-u*(2.1e-6)^2;
    sq=sq+1;
end
 
for sp=1:1:62
    ic(sp)=0;
end
for sp=63:1:273
    ic(sp)=sc(ee);
    ee=ee+1;
end
for sp=274:1:335
    ic(sp)=0;
end
 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  Diffusion  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
for z=1:1:(30/0.001)
    for s=2:1:334
        ic(s)=ic(s)+D*0.001*(ic(s-1)+ic(s+1)-2*ic(s))/((2e-8)^2);%2e-8 cm,0.2nm
    end
end
x5=wj;
y5=ic;
 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  Plot figure  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
plot(x1,y1,'-k','LineWidth',0.1);
hold on
plot(x2,y2,'sr');
hold on
plot(x3,y3,'*g','LineWidth',0.1);
hold on
plot(x4,y4,'xm','LineWidth',0.1);
hold on
plot(x5,y5,'ob','LineWidth',0.1);
axis([2.077e-4 2.163e-4 1e15 1.05e18]);
xlabel('X (cm)');
ylabel('concentration');
grid on